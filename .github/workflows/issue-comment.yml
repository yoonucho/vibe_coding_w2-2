name: Issue Auto Comment

on:
  issues:
    types: [opened]

jobs:
  issue-comment:
    runs-on: ubuntu-latest

    steps:
      - name: Add Issue Welcome Comment
        uses: actions/github-script@v7
        with:
          script: |
            const issue = context.payload.issue;
            const title = issue.title.toLowerCase();
            const body = (issue.body || '').toLowerCase();

            // ì´ìŠˆ íƒ€ì… ê°ì§€
            let issueType = 'general';
            if (title.includes('bug') || body.includes('bug') || title.includes('error')) {
              issueType = 'bug';
            } else if (title.includes('feature') || body.includes('feature')) {
              issueType = 'feature';
            } else if (title.includes('docs') || title.includes('documentation')) {
              issueType = 'docs';
            } else if (title.includes('question') || title.includes('help')) {
              issueType = 'question';
            }

            let comment = `## ğŸ“ ì´ìŠˆ ìƒì„± ê°ì‚¬í•©ë‹ˆë‹¤!

            ì´ìŠˆë¥¼ ë“±ë¡í•´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤. ë¹ ë¥¸ ì²˜ë¦¬ë¥¼ ìœ„í•´ ë‹¤ìŒ ê°€ì´ë“œë¼ì¸ì„ í™•ì¸í•´ì£¼ì„¸ìš”.

            `;

            // ì´ìŠˆ íƒ€ì…ë³„ ë§ì¶¤ ê°€ì´ë“œ
            switch(issueType) {
              case 'bug':
                comment += `### ğŸ› ë²„ê·¸ ë¦¬í¬íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸
                
                ì´ìŠˆ ë‚´ìš©ì— ë‹¤ìŒ ì •ë³´ê°€ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”:
                
                - [ ] **ì¬í˜„ ë‹¨ê³„**: ë²„ê·¸ë¥¼ ì¬í˜„í•  ìˆ˜ ìˆëŠ” êµ¬ì²´ì ì¸ ë‹¨ê³„
                - [ ] **ì˜ˆìƒ ë™ì‘**: ì •ìƒì ìœ¼ë¡œ ì‘ë™í•´ì•¼ í•˜ëŠ” ë°©ì‹
                - [ ] **ì‹¤ì œ ë™ì‘**: í˜„ì¬ ë°œìƒí•˜ëŠ” ë¬¸ì œ
                - [ ] **í™˜ê²½ ì •ë³´**: OS, ë¸Œë¼ìš°ì €, Python ë²„ì „ ë“±
                - [ ] **ì—ëŸ¬ ë¡œê·¸**: ì½˜ì†”ì´ë‚˜ ë¡œê·¸ íŒŒì¼ì˜ ì—ëŸ¬ ë©”ì‹œì§€
                - [ ] **ìŠ¤í¬ë¦°ìƒ·**: ê°€ëŠ¥í•œ ê²½ìš° ë¬¸ì œ ìƒí™© ìº¡ì²˜
                
                ### ğŸ” ì¶”ê°€ ì •ë³´
                - ì´ ë²„ê·¸ê°€ íŠ¹ì • ì¡°ê±´ì—ì„œë§Œ ë°œìƒí•˜ëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”
                - ìµœê·¼ ë³€ê²½ì‚¬í•­ê³¼ ê´€ë ¨ì´ ìˆëŠ”ì§€ ê²€í† í•´ë³´ì„¸ìš”`;
                break;
                
              case 'feature':
                comment += `### âœ¨ ê¸°ëŠ¥ ìš”ì²­ ì²´í¬ë¦¬ìŠ¤íŠ¸
                
                - [ ] **ëª…í™•í•œ ì„¤ëª…**: ìš”ì²­í•˜ëŠ” ê¸°ëŠ¥ì´ ë¬´ì—‡ì¸ì§€ ëª…í™•íˆ ì„¤ëª…
                - [ ] **ì‚¬ìš© ì‚¬ë¡€**: ì´ ê¸°ëŠ¥ì´ í•„ìš”í•œ êµ¬ì²´ì ì¸ ì‹œë‚˜ë¦¬ì˜¤
                - [ ] **ì˜ˆìƒ ì´ìµ**: ì´ ê¸°ëŠ¥ìœ¼ë¡œ ì–»ì„ ìˆ˜ ìˆëŠ” ì¥ì 
                - [ ] **ëŒ€ì•ˆ ê²€í† **: ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œ í•´ê²°í•  ìˆ˜ ìˆëŠ”ì§€ ê³ ë ¤
                - [ ] **ìš°ì„ ìˆœìœ„**: ì´ ê¸°ëŠ¥ì˜ ì¤‘ìš”ë„ í‘œì‹œ
                
                ### ğŸ’¡ êµ¬í˜„ ì œì•ˆ
                - ê°€ëŠ¥í•˜ë‹¤ë©´ êµ¬í˜„ ë°©í–¥ì„±ì´ë‚˜ ì•„ì´ë””ì–´ë¥¼ ê³µìœ í•´ì£¼ì„¸ìš”
                - ê´€ë ¨ ê¸°ì¡´ ê¸°ëŠ¥ì´ë‚˜ ìœ ì‚¬í•œ êµ¬í˜„ ì‚¬ë¡€ê°€ ìˆë‹¤ë©´ ì–¸ê¸‰í•´ì£¼ì„¸ìš”`;
                break;
                
              case 'docs':
                comment += `### ğŸ“š ë¬¸ì„œ ê´€ë ¨ ì´ìŠˆ ì²´í¬ë¦¬ìŠ¤íŠ¸
                
                - [ ] **ëŒ€ìƒ ë¬¸ì„œ**: ì–´ë–¤ ë¬¸ì„œì— ëŒ€í•œ ì´ìŠˆì¸ì§€ ëª…ì‹œ
                - [ ] **ë¬¸ì œì **: í˜„ì¬ ë¬¸ì„œì˜ ì–´ë–¤ ë¶€ë¶„ì´ ë¬¸ì œì¸ì§€ ì„¤ëª…
                - [ ] **ê°œì„  ë°©í–¥**: ì–´ë–»ê²Œ ê°œì„ ë˜ì–´ì•¼ í•˜ëŠ”ì§€ ì œì•ˆ
                - [ ] **ëŒ€ìƒ ë…ì**: ëˆ„êµ¬ë¥¼ ìœ„í•œ ë¬¸ì„œì¸ì§€ ê³ ë ¤
                
                ### ğŸ“ ë¬¸ì„œ ì‘ì„± ê°€ì´ë“œ
                - ëª…í™•í•˜ê³  ì´í•´í•˜ê¸° ì‰¬ìš´ ì–¸ì–´ ì‚¬ìš©
                - ì‹¤ìš©ì ì¸ ì˜ˆì‹œ í¬í•¨
                - ë‹¨ê³„ë³„ ì„¤ëª… ì œê³µ`;
                break;
                
              case 'question':
                comment += `### â“ ì§ˆë¬¸ í•´ê²° ê°€ì´ë“œ
                
                - [ ] **êµ¬ì²´ì ì¸ ì§ˆë¬¸**: ë¬´ì—‡ì„ ì•Œê³  ì‹¶ì€ì§€ ëª…í™•íˆ í‘œí˜„
                - [ ] **ì‹œë„í•œ ë°©ë²•**: ì´ë¯¸ ì‹œë„í•´ë³¸ í•´ê²° ë°©ë²•ë“¤
                - [ ] **ê´€ë ¨ ì½”ë“œ**: í•´ë‹¹í•˜ëŠ” ê²½ìš° ê´€ë ¨ ì½”ë“œ ê³µìœ 
                - [ ] **í™˜ê²½ ì •ë³´**: ê°œë°œ í™˜ê²½ ë° ì„¤ì • ì •ë³´
                
                ### ğŸ’¬ ë¹ ë¥¸ ë‹µë³€ì„ ìœ„í•œ íŒ
                - ë¬¸ì œ ìƒí™©ì„ ìµœëŒ€í•œ êµ¬ì²´ì ìœ¼ë¡œ ì„¤ëª…í•´ì£¼ì„¸ìš”
                - ê´€ë ¨ ë¬¸ì„œë‚˜ ìë£Œë¥¼ ë¨¼ì € í™•ì¸í•´ë³´ì„¸ìš”`;
                break;
                
              default:
                comment += `### ğŸ“‹ ì¼ë°˜ ì´ìŠˆ ê°€ì´ë“œ
                
                - [ ] **ëª…í™•í•œ ì œëª©**: ì´ìŠˆ ë‚´ìš©ì„ ì˜ í‘œí˜„í•˜ëŠ” ì œëª©
                - [ ] **ìƒì„¸í•œ ì„¤ëª…**: ì´ìŠˆì— ëŒ€í•œ ì¶©ë¶„í•œ ì„¤ëª…
                - [ ] **ê´€ë ¨ ì •ë³´**: ì°¸ê³ í•  ë§Œí•œ ë§í¬ë‚˜ ìë£Œ
                - [ ] **ìš°ì„ ìˆœìœ„**: ì´ìŠˆì˜ ì¤‘ìš”ë„ë‚˜ ê¸´ê¸‰ë„`;
                break;
            }

            comment += `

            ## ğŸ·ï¸ ë¼ë²¨ë§ ì•ˆë‚´

            ë‹´ë‹¹ìê°€ ì ì ˆí•œ ë¼ë²¨ì„ ìë™/ìˆ˜ë™ìœ¼ë¡œ í• ë‹¹í•  ì˜ˆì •ì…ë‹ˆë‹¤:
            - **íƒ€ì…**: \`bug\`, \`enhancement\`, \`feature\`, \`documentation\`, \`question\`
            - **ìš°ì„ ìˆœìœ„**: \`priority:high\`, \`priority:medium\`, \`priority:low\`
            - **ì»´í¬ë„ŒíŠ¸**: \`component:backend\`, \`component:frontend\`, \`component:docs\`

            ## ğŸ‘¥ ë‹´ë‹¹ì í• ë‹¹

            24ì‹œê°„ ë‚´ì— ì ì ˆí•œ ë‹´ë‹¹ìê°€ í• ë‹¹ë©ë‹ˆë‹¤. ê¸´ê¸‰í•œ ì‚¬ì•ˆì˜ ê²½ìš° ì œëª©ì— **[URGENT]**ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”.

            ## ğŸ“… ì²˜ë¦¬ ì¼ì •

            - **ë²„ê·¸**: 3-5ì¼ ë‚´ ì´ˆê¸° ë¶„ì„
            - **ê¸°ëŠ¥ ìš”ì²­**: 1-2ì£¼ ë‚´ ê²€í†  ë° í”¼ë“œë°±  
            - **ë¬¸ì„œ**: 1ì£¼ ë‚´ ì—…ë°ì´íŠ¸
            - **ì§ˆë¬¸**: 1-3ì¼ ë‚´ ë‹µë³€

            ---

            ğŸ¤– ì´ ëŒ“ê¸€ì€ ìë™ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤. ì¶”ê°€ ì§ˆë¬¸ì´ ìˆìœ¼ì‹œë©´ ì–¸ì œë“  ëŒ“ê¸€ë¡œ ë‚¨ê²¨ì£¼ì„¸ìš”!`;

            await github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: comment
            });

  triage-notification:
    runs-on: ubuntu-latest

    steps:
      - name: Notify triage needed
        uses: actions/github-script@v7
        with:
          script: |
            const issue = context.payload.issue;
            const title = issue.title;
            const body = issue.body || '';

            // ê¸´ê¸‰ ì´ìŠˆ ê°ì§€
            const isUrgent = title.toLowerCase().includes('urgent') || 
                            title.toLowerCase().includes('critical') ||
                            body.toLowerCase().includes('urgent') ||
                            body.toLowerCase().includes('critical');

            if (isUrgent) {
              const urgentComment = `## ğŸš¨ ê¸´ê¸‰ ì´ìŠˆ ê°ì§€
              
              ì´ ì´ìŠˆê°€ ê¸´ê¸‰ìœ¼ë¡œ ë¶„ë¥˜ë˜ì—ˆìŠµë‹ˆë‹¤.
              
              ### ì¦‰ì‹œ ì²˜ë¦¬ í•„ìš” ì‚¬í•­:
              - [ ] ë‹´ë‹¹ì ì¦‰ì‹œ í• ë‹¹
              - [ ] ì´ˆê¸° ë¶„ì„ ë° ì‘ë‹µ (2ì‹œê°„ ë‚´)
              - [ ] í•´ê²° ê³„íš ìˆ˜ë¦½ (24ì‹œê°„ ë‚´)
              
              ë‹´ë‹¹ìê°€ ê³§ í™•ì¸í•  ì˜ˆì •ì…ë‹ˆë‹¤.
              
              ---
              ğŸš¨ ê¸´ê¸‰ ì´ìŠˆ ìë™ ì•Œë¦¼`;
              
              await github.rest.issues.createComment({
                issue_number: context.issue.number,
                owner: context.repo.owner,
                repo: context.repo.repo,
                body: urgentComment
              });
            }
